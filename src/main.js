import { Telegraf } from "telegraf"
import { message } from "telegraf/filters"
import config from "config"
import { getMainMenu, getProductMenu, getOtherArea, getBuy, yesNoKeyboard} from "./keyboard.js";
import { getCurrentCnyRubCourse } from "./currentValueCourse.js";

const bot = new Telegraf(config.get('TELEGRAM_TOKEN'), {
    handlerTimeout: Infinity,
});

bot.command('start', async (ctx) => {
    await ctx.replyWithPhoto({source: './img/IMG_main.png'})
    await ctx.reply(`–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, ${ctx.message.chat.first_name}! \n–Ø –≤–∞—à –ª–∏—á–Ω—ã–π –±–æ—Ç-–ø–æ–º–æ—â–Ω–∏–∫, –Ω–∏–∂–µ –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å –º–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:`, getMainMenu())
});

//bot hears

bot.hears('–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞ üíµ', async ctx => {
    await ctx.reply('–í—ã–±–µ—Ä–∏—Ç–µ –ø–ª–æ—â–∞–¥–∫—É, —Å –∫–æ—Ç–æ—Ä–æ–π –≤—ã —Ö–æ—Ç–µ–ª–∏ –±—ã –æ—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑:', getOtherArea())
    await ctx.reply('–î–ª—è —Ç–æ–≥–æ —á—Ç–æ–±—ã –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Poizon, –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ö–∞–∫ —Å–∫–∞—á–∞—Ç—å Poizon? ü§î"')
})

bot.hears('Poizon üí∞', ctx => {
    ctx.reply('–í—ã–±–µ—Ä–µ—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∫ –∫–æ—Ç–æ—Ä–æ–π –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –≤—ã–±—Ä–∞–Ω–Ω–∞—è –≤–∞–º–∏ –≤–µ—â—å:', getProductMenu())
})

bot.hears('–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ Poizon: üìù', async ctx => {
    await ctx.replyWithPhoto({source: './img/IMG_01.png'}, {caption: '–®–∞–≥ 1 ‚úÖ'}, {disable_notification: true})
    await ctx.replyWithPhoto({source: './img/IMG_02.png'}, {caption: '–®–∞–≥ 2 ‚úÖ'})
    await ctx.replyWithPhoto({source: './img/IMG_03.png'}, {caption: '–®–∞–≥ 3 ‚úÖ'})
    await ctx.replyWithPhoto({source: './img/IMG_04.png'}, {caption: '–®–∞–≥ 4 ‚úÖ'})
    await ctx.replyWithPhoto({source: './img/IMG_05.png'}, {caption: '–®–∞–≥ 5 ‚úÖ'})
    await ctx.replyWithPhoto({source: './img/IMG_06.png'}, {caption: '–®–∞–≥ 6 ‚úÖ'})
    await ctx.reply('–¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞—à–µ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É –¥–ª—è –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞: üîΩ\nhttps://t.me/freshPlayerShop\n\n–®–∞–≥ 7 ‚úÖ')
})

bot.hears('–û–±—É–≤—å üëü', async ctx => {
    await ctx.reply('–í–≤–µ–¥–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–µ–ª–∞–µ–º–æ–π –≤–µ—â–∏ –≤ —é–∞–Ω—è—Ö (—Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –≤–µ—â–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)\n\n1.–í—ã–±–µ—Ä–µ—Ç–µ –Ω—É–∂–Ω—ã–π —Ç–æ–≤–∞—Ä –Ω–∞ Poizon –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—Ä–∞–≤—É—é –Ω–∏–∂–Ω—é—é –∫–Ω–æ–ø–∫—É\n2.–í—ã–±–µ—Ä–µ—Ç–µ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Ü–µ–Ω—É,–∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑–∞–Ω–∞ –ø–µ—Ä–≤–æ–π')
})

bot.hears('–ö–æ—Ñ—Ç—ã/—à—Ç–∞–Ω—ã üëñ', async ctx => {
    await ctx.reply('–í–≤–µ–¥–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–µ–ª–∞–µ–º–æ–π –≤–µ—â–∏ –≤ —é–∞–Ω—è—Ö (—Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –≤–µ—â–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)\n\n1.–í—ã–±–µ—Ä–µ—Ç–µ –Ω—É–∂–Ω—ã–π —Ç–æ–≤–∞—Ä –Ω–∞ Poizon –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—Ä–∞–≤—É—é –Ω–∏–∂–Ω—é—é –∫–Ω–æ–ø–∫—É\n2.–í—ã–±–µ—Ä–µ—Ç–µ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Ü–µ–Ω—É,–∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑–∞–Ω–∞ –ø–µ—Ä–≤–æ–π')
})

bot.hears('–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã/—Ñ—É—Ç–±–æ–ª–∫–∏/–±–µ–ª—å–µ üëï', async ctx => {
    await ctx.reply('–í–≤–µ–¥–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–µ–ª–∞–µ–º–æ–π –≤–µ—â–∏ –≤ —é–∞–Ω—è—Ö (—Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –≤–µ—â–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)\n\n1.–í—ã–±–µ—Ä–µ—Ç–µ –Ω—É–∂–Ω—ã–π —Ç–æ–≤–∞—Ä –Ω–∞ Poizon –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—Ä–∞–≤—É—é –Ω–∏–∂–Ω—é—é –∫–Ω–æ–ø–∫—É\n2.–í—ã–±–µ—Ä–µ—Ç–µ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Ü–µ–Ω—É,–∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑–∞–Ω–∞ –ø–µ—Ä–≤–æ–π')
})

bot.hears('–í–µ—Ä—Ö–Ω—è—è –æ–¥–µ–∂–¥–∞ ü¶∫', async ctx => {
    await ctx.reply('–í–≤–µ–¥–∏—Ç–µ —Å—Ç–æ–∏–º–æ—Å—Ç—å –∂–µ–ª–∞–µ–º–æ–π –≤–µ—â–∏ –≤ —é–∞–Ω—è—Ö (—Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –≤–µ—â–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ)\n\n1.–í—ã–±–µ—Ä–µ—Ç–µ –Ω—É–∂–Ω—ã–π —Ç–æ–≤–∞—Ä –Ω–∞ Poizon –∏ –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –ø—Ä–∞–≤—É—é –Ω–∏–∂–Ω—é—é –∫–Ω–æ–ø–∫—É\n2.–í—ã–±–µ—Ä–µ—Ç–µ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ –Ω–∞–ø–∏—à–∏—Ç–µ —Ü–µ–Ω—É,–∫–æ—Ç–æ—Ä–∞—è –ø–æ–∫–∞–∑–∞–Ω–∞ –ø–µ—Ä–≤–æ–π')
})

bot.hears('–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ ‚úÖ', ctx => {
    ctx.reply('–î–ª—è –æ–ø–ª–∞—Ç—ã –∑–∞–∫–∞–∑–∞ –ø—Ä–∏—à–ª–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–º–µ—Ä –∏ —Ñ–æ—Ç–æ –Ω–∞—à–µ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É:\n\nhttps://t.me/freshPlayerShop', getMainMenu())
})

bot.hears('–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ç–µ–∫—É—â–∏–π –∫—É—Ä—Å: üí¥', async ctx => {
    let currentPriceCourse = await getCurrentCnyRubCourse() + 0.6
    ctx.replyWithHTML(`–¢–µ–∫—É—â–∏–π –∫—É—Ä—Å –Æ–∞–Ω—è –∫ –†—É–±–ª—é: ${currentPriceCourse.toFixed(1)}‚ÇΩ`)
})

bot.hears('–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥ üîö',  ctx => {
    ctx.reply('–í—ã–±–µ—Ä–µ—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â—É—é –≤–∞—Å –∫–∞—Ç–µ–≥–æ—Ä–∏—é:', getMainMenu())
})

bot.hears('–î—Ä—É–≥–∏–µ —Ç–æ–≤–∞—Ä—ã üß¢', ctx => {
    ctx.reply('–ï—Å–ª–∏ –≤–∞—à–µ–≥–æ —Ç–æ–≤–∞—Ä–∞ –Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞—à–∏–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º:\nhttps://t.me/freshPlayerShop', getMainMenu())
})


// bot on

bot.on(message('text'), async ctx => {
    switch(ctx.message.text){
        case '–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ –∏–ª–∏ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –Ω–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ üôã‚Äç‚ôÇÔ∏è': 
        ctx.reply('–ù–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –ø–æ–¥–æ–±—Ä–∞—Ç—å –ª—é–±–æ–π –æ–±—Ä–∞–∑, –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å—Å—è —Å —Ä–∞–∑–º–µ—Ä–æ–º, –∞ —Ç–∞–∫ –∂–µ —Å–æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ—Ç –≤–∞—Å –ø–æ —Ç–æ–≤–∞—Ä–∞–º –≤ –Ω–∞–ª–∏—á–∏–∏. –ù–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –∏ –∑–∞–¥–∞–≤–∞–π—Ç–µ –ª—é–±–æ–π –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–π –≤–∞—Å –≤–æ–ø—Ä–æ—Å üîΩ\nhttps://t.me/freshPlayerShop')
        break;
        case '–ê–∫—Ü–∏–∏ –∏ –ø—Ä–æ–º–æ–∫–æ–¥—ã üòç' :
        ctx.reply('–°–∫–æ—Ä–æ –º—ã –¥–æ–±–∞–≤–∏–º —ç—Ç–æ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª ‚ò∫Ô∏è')
        break;
        case '–ö–∞–∫ —Å–∫–∞—á–∞—Ç—å Poizon? ü§î' :
        ctx.reply('–°—Å—ã–ª–∫–∏ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è Poizon –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–∏–∂–µ: üîΩ', yesNoKeyboard())
        break;
        case '–û—Ç–∑—ã–≤—ã üíå': 
        ctx.reply('–û—Å—Ç–∞–≤–ª—è–π –æ—Ç–∑—ã–≤ –∏ –ø–æ–ª—É—á–∞–π —Å–∫–∏–¥–∫—É 5% –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –∑–∞–∫–∞–∑!\n\n–û—Ç–∑—ã–≤—ã –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –Ω–∞—à–µ–º —á–∞—Ç–µ, –ø–µ—Ä–µ–π–¥—è –ø–æ —Å—Å—ã–ª–∫–µ –Ω–∏–∂–µ: üîΩ\nhttps://t.me/+8LmtumijfagxYWJi')
        break;
    }

    let current = await getCurrentCnyRubCourse() + 0.6
    if(ctx.message.text > 0) {
        let finalPrice = Math.ceil(current.toFixed(1) * ctx.message.text + 400)
        ctx.replyWithHTML(`–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å: ${finalPrice}‚ÇΩ (—Å —É—á—ë—Ç–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏) + –¥–æ—Å—Ç–∞–≤–∫–∞ –≤ –≤–∞—à —Ä–µ–≥–∏–æ–Ω (–ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏, –°–î–≠–ö)\n\n<b>–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∑–∞ –≤–µ—Å—å –∑–∞–∫–∞–∑</b>`, getBuy())
    }
})


bot.launch();